# Лог ошибок и их исправлений

## Структура записи:
1. Что сломалось
2. Как починил
3. В каком файле была ошибка
4. Советы по избеганию

## Текущие ошибки:
- Пока ошибок не обнаружено

## Советы по избеганию ошибок:
1. Всегда проверять наличие необходимых permissions
2. Использовать remember для состояний в Compose
3. Правильно обрабатывать жизненный цикл Activity
4. Следить за утечками памяти при использовании WakeLock

# Журнал ошибок и их решений

## Рекомендации по избеганию ошибок:
1. Всегда проверяйте наличие необходимых разрешений перед выполнением операций с приложениями
2. Используйте try-catch блоки при работе с системными API
3. Проверяйте null значения при работе с PackageManager
4. Используйте корутины для асинхронных операций
5. Обрабатывайте случаи когда приложение может быть удалено во время работы с ним
6. При запуске приложений проверяйте наличие LAUNCHER активности
7. При работе с системными приложениями проверяйте наличие ROOT прав
8. При извлечении APK проверяйте наличие разрешения на запись
9. При резервном копировании проверяйте наличие свободного места
10. При принудительной остановке приложений проверяйте наличие FORCE_STOP_PACKAGES разрешения

## Известные ошибки:

### 1. Ошибка при загрузке иконок приложений
- **Проблема**: Возможен NullPointerException при попытке загрузить иконку приложения
- **Решение**: Добавлена проверка на null и использование placeholder иконки
- **Файл**: compose/src/main/java/com/walhalla/compose/ui/screens/home/HomeScreen.kt
- **Рекомендация**: Всегда предусматривайте fallback для ресурсов, которые могут быть недоступны

### 2. Ошибка при работе с системными приложениями
- **Проблема**: SecurityException при попытке выполнить операции с системными приложениями
- **Решение**: Добавлена проверка isSystemApp и соответствующая обработка
- **Файл**: compose/src/main/java/com/walhalla/compose/ui/screens/home/HomeScreen.kt
- **Рекомендация**: Разделяйте логику для системных и пользовательских приложений

### 3. Ошибка при навигации
- **Проблема**: IllegalArgumentException при попытке навигации с невалидными параметрами
- **Решение**: Добавлена валидация параметров перед навигацией
- **Файл**: compose/src/main/java/com/walhalla/compose/MainActivity.kt
- **Рекомендация**: Всегда проверяйте корректность параметров навигации

### 4. Ошибка при запуске приложений
- **Проблема**: ActivityNotFoundException при попытке запуска приложения
- **Решение**: Добавлена проверка наличия LAUNCHER активности
- **Файл**: compose/src/main/java/com/walhalla/compose/ui/screens/home/HomeScreen.kt
- **Рекомендация**: Проверяйте наличие LAUNCHER активности перед запуском

### 5. Ошибка при извлечении APK
- **Проблема**: SecurityException при попытке извлечь APK файл
- **Решение**: Добавлена проверка разрешений и использование FileProvider
- **Файл**: compose/src/main/java/com/walhalla/compose/ui/screens/home/HomeScreen.kt
- **Рекомендация**: Используйте FileProvider для работы с файлами приложений

### 6. Ошибка при принудительной остановке
- **Проблема**: SecurityException при попытке остановить системное приложение
- **Решение**: Добавлена проверка ROOT прав и FORCE_STOP_PACKAGES разрешения
- **Файл**: compose/src/main/java/com/walhalla/compose/ui/screens/home/HomeScreen.kt
- **Рекомендация**: Проверяйте наличие необходимых прав перед выполнением системных операций

# Лог ошибок AppExtractor

## Формат записи:
- Что сломалось
- Как починил
- В каком файле была ошибка
- Советы по избеганию

## Известные ошибки:

### 1. ClassNotFoundException при загрузке ресурсов
- Проблема: При попытке загрузить ресурсы из другого приложения возникает ClassNotFoundException
- Решение: Добавлен флаг CONTEXT_INCLUDE_CODE при создании контекста
- Файл: app/src/main/java/com/walhalla/appextractor/activity/string/StringsPresenter.java
- Совет: Всегда использовать CONTEXT_INCLUDE_CODE | CONTEXT_IGNORE_SECURITY при работе с ресурсами других приложений

### 2. SecurityException при запуске компонентов
- Проблема: SecurityException при попытке запуска активностей/сервисов
- Решение: Добавлены флаги FLAG_ACTIVITY_NEW_TASK и FLAG_GRANT_READ_URI_PERMISSION
- Файл: extractor/src/main/java/com/walhalla/appextractor/utils/LauncherUtils.kt
- Совет: Проверять exported флаг компонента перед запуском

# Лог ошибок и их решений

## Навигация
### Ошибка: Неправильная навигация между экранами
- Проблема: При использовании TabRow с HorizontalPager возникали проблемы с сохранением состояния экранов
- Решение: Переход на Navigation Component с BottomNavigationBar
- Файл: compose/src/main/java/com/walhalla/compose/MainActivity.kt
- Совет: Использовать Navigation Component для более надежной навигации и управления состоянием

## Состояние приложения
### Ошибка: Потеря состояния при повороте экрана
- Проблема: При повороте экрана терялись введенные данные в настройках
- Решение: Использование rememberSaveable вместо remember для сохранения состояния
- Файл: compose/src/main/java/com/walhalla/compose/screens/SettingsScreen.kt
- Совет: Всегда использовать rememberSaveable для данных, которые должны переживать изменения конфигурации

## Разрешения
### Ошибка: Отсутствие необходимых разрешений
- Проблема: Приложение крашилось при попытке доступа к файловой системе
- Решение: Добавлена проверка и запрос разрешений через registerForActivityResult
- Файл: compose/src/main/java/com/walhalla/compose/screens/ExtractorScreen.kt
- Совет: Всегда проверять наличие разрешений перед выполнением операций, требующих их

## Файловая система
### Ошибка: Проблемы с доступом к файлам
- Проблема: Невозможность чтения/записи файлов на Android 10+
- Решение: Использование MediaStore API и Storage Access Framework
- Файл: compose/src/main/java/com/walhalla/compose/screens/LogScreen.kt
- Совет: Учитывать Scoped Storage на Android 10+ и использовать соответствующие API

## Compose
### Ошибка: Проблемы с производительностью
- Проблема: Лаги при прокрутке больших списков
- Решение: Использование LazyColumn вместо Column + ScrollView
- Файл: compose/src/main/java/com/walhalla/compose/screens/ExtractorScreen.kt
- Совет: Использовать ленивые компоненты для больших списков

## ViewModels
### Ошибка: Утечки памяти
- Проблема: Утечки при использовании корутин
- Решение: Использование viewModelScope и правильная отмена корутин
- Файл: compose/src/main/java/com/walhalla/compose/viewmodel/SettingsViewModel.kt
- Совет: Всегда использовать viewModelScope для корутин в ViewModel 
## Архитектура
- Современная Compose архитектура:
  * UI Layer (Screens) - только отображение состояния
  * Presentation Layer (ViewModels) - логика UI и состояние
  * Domain Layer (Services) - бизнес-логика
  * Data Layer (Repositories) - данные

- Отличия от старой архитектуры:
  * Нет отдельных контроллеров (Activity/Fragment)
  * Composable функции заменяют контроллеры
  * ViewModel содержит всю логику UI
  * Чистые и однонаправленные потоки данных

- Модули:
  * :app - главный модуль приложения
  * :domain - бизнес-логика (чистый Kotlin)
  * :data - реализации репозиториев
  * :ui - переиспользуемые UI компоненты

- Слои:
  * Data Layer - работа с данными (Repository Pattern)
  * Domain Layer - бизнес-логика (Services/Use Cases)
  * Presentation Layer - ViewModels и состояния
  * UI Layer - Compose экраны и компоненты

- Зависимости:
  * UI -> Presentation -> Domain <- Data
  * Domain не зависит от Android
  * Data реализует интерфейсы из Domain

- Правильный поток данных:
  * Controller (UI) -> ViewModel
  * ViewModel -> Service
  * Service -> Repository

- Принципы взаимодействия:
  * Контроллер работает ТОЛЬКО с ViewModel
  * ViewModel инкапсулирует работу с сервисами
  * Сервис содержит переиспользуемую бизнес-логику
  * Repository абстрагирует источники данных

- 3-х слойная архитектура:
  * UI Layer (Screens/ViewModels) - отвечает за отображение и обработку пользовательского ввода
  * Domain Layer (Services) - содержит бизнес-логику
  * Data Layer (Repositories) - работа с данными

- Контроллеры (UI Layer):
  * Screens в Compose
  * Обработка UI событий
  * Делегирование бизнес-логики в сервисы через ViewModel

- Service Layer (Domain):
  * Независим от UI
  * Содержит чистую бизнес-логику
  * Работает через абстракции репозиториев

- Обнаружены все наследники BaseViewModel (7 классов)
- BaseViewModel используется как интерфейс-маркер для моделей представления
- Классы используются для отображения различной информации об анализируемом приложении:
  * Заголовки (обычные и сворачиваемые)
  * Информация об Activity (className, label, exported, icon, intentFilters)
  * Информация о Service
  * Флаги приложения
  * Данные сертификатов
  * Простые строки информации
- Модуль extractor - это библиотека для:
  * Извлечения информации о приложениях
  * Бэкапа APK файлов в облако
  * Анализа компонентов приложений
- Рефакторинг:
  * Все модели перенесены в единый файл sdk/ViewModels.kt
  * Добавлены toString() методы для отладки
  * Удалены разрозненные файлы с определениями моделей
  * Добавлен пропущенный ServiceLine в общий файл
  * Исправлена структура ActivityLine согласно реальному использованию 
- Repository Pattern:
  * Абстракция над источниками данных
  * CRUD операции с данными
  * Работа с PackageManager, файловой системой и т.д.
- Service Layer:
  * Бизнес-логика приложения
  * Координация работы репозиториев
  * Анализ APK, бэкап, извлечение компонентов

## Локализация
- Добавлены строковые ресурсы для действий с приложением:
  * Базовые действия (запуск, информация, извлечение APK)
  * Просмотр компонентов (манифест, ресурсы, активити)
  * Управление приложением (отключение, остановка, удаление)

## Angular 19 Архитектура

### Слои приложения:
1. View Layer (Components):
   - Отображение UI
   - Шаблоны (templates)
   - Стили
   - Привязка данных (data binding)

2. Controller Layer:
   - Обработка событий UI
   - Навигация
   - Валидация входных данных
   - Делегирование в Presenter

3. Presenter Layer:
   - Форматирование данных для View
   - Управление состоянием UI
   - UI логика
   - Делегирование бизнес-операций в Service

4. Domain Layer (Services):
   - Бизнес-логика
   - Координация репозиториев
   - Независимость от UI

5. Data Layer (Repositories):
   - Работа с API
   - Кэширование
   - Хранение данных

### Поток данных:

## Архитектура Compose
- Слои и примеры классов:
  * UI Layer (Screens):
    - HomeScreen.kt - главный экран со списком приложений
    - AppDetailsScreen.kt - детали приложения
    - SettingsScreen.kt - настройки
    - BackupScreen.kt - экран бэкапа

  * Presentation Layer (ViewModels):
    - HomeViewModel.kt - логика главного экрана
    - AppDetailsViewModel.kt - логика экрана деталей
    - SettingsViewModel.kt - логика настроек
    - BackupViewModel.kt - логика бэкапа

  * Domain Layer (Services):
    - AppAnalysisService.kt - анализ приложений
    - BackupService.kt - бэкап приложений
    - PackageManagerService.kt - работа с пакетами
    - PermissionService.kt - работа с разрешениями

  * Data Layer (Repositories):
    - PackageRepository.kt - доступ к установленным приложениям
    - BackupRepository.kt - сохранение бэкапов
    - SettingsRepository.kt - настройки приложения
    - DatabaseRepository.kt - локальная база данных 

## Миграция на Compose
- Исправлена интеграция с extractor:
  * Корректное использование ExtractorHelper.EXTRACT_ONE_PLEASE
  * Реализация ExtractorHelper.Callback
  * Добавлены все поддерживаемые действия
  * Убрано использование Dagger/Hilt, переход на ручное внедрение зависимостей

- Поддерживаемые действия:
  * Запуск приложения (через PackageManager)
  * Просмотр информации (через Settings)
  * Извлечение APK (через ExtractorHelper)
  * Бэкап приложения (через ExtractorHelper)
  * Отключение приложения (через Settings)
  * Принудительная остановка (через Settings)
  * Удаление приложения (через Intent.ACTION_DELETE)

- Следующие шаги:
  * Реализовать обратную связь в UI для ExtractorHelper.Callback
  * Добавить поиск, сортировку и фильтрацию
  * Улучшить UX (анимации, переходы, диалоги)

- Улучшения UI:
  * Меню действий для каждого приложения
  * Snackbar для отображения ошибок
  * Ripple эффект на карточках
  * Иконки для всех действий

- Интеграция с extractor:
  * Использование ExtractorHelper
  * Сохранение оригинального API
  * Добавление новых методов

- Создана базовая структура:
  * UI Layer: HomeScreen, AppList, HomeTopBar
  * Presentation Layer: HomeViewModel, HomeState
  * Domain Layer: AppService
  * Data Layer: PackageRepository

- Использование современных подходов:
  * Jetpack Compose для UI
  * Flow для реактивности
  * Clean Architecture
  * Dependency Injection
  * Переиспользуемые компоненты

- Следующие шаги:
  * Портировать остальные экраны
  * Добавить навигацию
  * Реализовать диалоги
  * Перенести оставшийся функционал 

## Улучшение интерфейса ManifestScreen
- Добавлены анимации переходов между состояниями
- Добавлены Ripple эффекты на все кнопки
- Улучшен UX с анимированным Snackbar
- Оптимизирована работа с WebView
- Добавлен монохромный шрифт для манифеста
- Улучшено отображение ошибок с иконкой
- Добавлена анимация переходов между табами split APK

## Безопасность
- Отключен JavaScript в WebView
- Добавлена очистка WebView при смене страницы
- Улучшена обработка ошибок при загрузке манифестов

## Оптимизации
- Использование DisposableEffect для очистки ресурсов
- Оптимизированы анимации для плавной работы
- Улучшена обработка состояний через AnimatedContent 

# Функционал приложения

## Улучшение интерфейса
- Добавлена система частиц
- Добавлен HorizontalPager с вкладками INFO, META, STRING и XML
- Добавлен MetaScreen для отображения метаданных приложения:
  - Application MetaData
  - Activities MetaData
  - Receivers MetaData
  - Services MetaData
  - Providers MetaData
- Добавлен StringScreen для отображения строковых ресурсов:
  - Отображение имени и значения ресурса
  - Копирование имени и значения в буфер обмена
  - Поддержка поделиться ресурсом
  - Поддержка просмотра XML ресурсов
  - Отображение иконок для разных типов ресурсов

## Исправления ошибок
- Исправлено отображение активностей в списке
- Добавлена поддержка копирования в буфер обмена
- Улучшена обработка ошибок при загрузке ресурсов

## Рекомендации
- Использовать Material3 для современного дизайна
- Добавить анимации при переходах между экранами
- Улучшить обработку ошибок при загрузке ресурсов
- Добавить поддержку тёмной темы 